<%
   @title = :species_list_show_title.t(name: @species_list.unique_format_name)
   right_links = []
   if @user
     right_links << link_with_query(:species_list_show_clone_list.t,
                                    {action: 'create_species_list', clone: @species_list.id},
                                    {help: :species_list_show_clone_list_help.l})
     right_links << link_with_query(:species_list_show_set_source.t,
                                    {action: 'show_species_list', id: @species_list.id,
                                     set_source: 1},
                                    {help: :species_list_show_set_source_help.l})
     right_links << link_with_query(:species_list_show_bulk_edit.t,
                                    {action: 'bulk_editor', id: @species_list.id},
                                    {help: :species_list_show_bulk_edit_help.l})
     right_links << draw_interest_icons(@species_list)
   end
   if check_permission(@species_list)
     right_links << link_with_query(:species_list_show_manage_projects.t,
                                   action: 'manage_projects', id: @species_list.id)
     right_links << link_with_query(:species_list_show_edit.t,
                                   action: 'edit_species_list', id: @species_list.id)
     right_links << link_with_query(:DESTROY.t,
                                   {action: 'destroy_species_list', id: @species_list.id},
                                   {class: "text-danger", data: {confirm: :are_you_sure.l}})
   end
   right_links << content_tag(:div,
                             "#{link_with_query(:species_list_show_save_as_txt.t, action: 'make_report',
                                                id: @species_list.id, type: 'txt')} |
    #{link_with_query(:species_list_show_save_as_rtf.t, action: 'make_report',
                      id: @species_list.id, type: 'rtf')} |
    #{link_with_query(:species_list_show_save_as_csv.t, action: 'make_report',
                      id: @species_list.id, type: 'csv')}".html_safe)

   @tabsets = {pager_for: @species_list,
               right: render(partial: "shared/tab_set", locals: {links: right_links})
   }

%>

<div class="row">
  <div class="col-xs-12">
    <div class="list-group">
      <div class="list-group-item">
        <div><%= :WHEN.t %>: <%= @species_list.when.web_date %></div>
        <div><%= :OBSERVATIONS.t %>: <%= @query.num_results %></div>
        <div><%= :WHERE.t %>:
          <%= location_link(@species_list.place_name, @species_list.location, nil, true) rescue :UNKNOWN.t %>
        </div>
        <div><%= :WHO.t %>: <%= user_link(@species_list.user) %></div>
        <% if @species_list.projects.any? %>
            <div>
              <%= :PROJECTS.t %>: <%= @species_list.projects.map { |p| project_link(p) }.safe_join(' | ') %>
            </div>
        <% end %>
        <div>
          <%= :NOTES.t %>:<br/>
          <%= @species_list.notes.to_s.tpl %>
        </div>
      </div>
    </div>
  </div>
</div>

<% if @pages && @pages.length > 0
     set_query_params(@query) %>
    <div class="list-group-item">
      <%= :species_list_show_members.t %>:
      <%= link_with_query(:show_objects.t(type: :observation),
                          controller: :observer, action: :index_observation) %> |
      <%= link_with_query(:show_objects.t(type: :image),
                          controller: :image, action: :index_image) %> |
      <%= link_with_query(:show_objects.t(type: :name),
                          controller: :name, action: :index_name) %> |
      <%= link_to(:app_checklist.t,
                  controller: :observer, action: :checklist,
                  species_list_id: @species_list.id) %>
      <% if Rails.env == "development" || is_reviewer? %>
          | <%= link_to(:species_list_show_print_labels.t,
                        controller: :species_list, action: :print_labels,
                        id: @species_list.id) %>
      <% end %>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <%= pagination_numbers(@pages) %>
      </div>
      <div class="col-xs-12">
        <div class="list-group">
          <% if @objects && @objects.length > 0 %>
              <% @objects.each do |observation| %>
                  <div class="list-group-item">
                    <div class="row">
                      <div class="col-sm-4">
                        <%= thumbnail(observation.thumb_image,
                                      link: {controller: :observer, action: :show_observation, id: observation.id},
                                      votes: true) if observation.thumb_image_id %>
                      </div>
                      <div class="col-sm-8">
                        <div class="bold">
                          <%= link_with_query(observation.unique_format_name.t,
                                              controller: 'observer', action: 'show_observation', id: observation.id) %>
                        </div>
                        <div>
                          <strong><%= location_link(observation.place_name, observation.location) %></strong>
                          <br><span><%= user_link(observation.user) %></span>:
                          <span><%= observation.when.web_date %></span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--/list group item-->
              <% end %>
          <% end %>
        </div>
      </div>
      <div class="col-xs-12">
        <%= pagination_numbers(@pages) %>
      </div>
<% else %>
    <div class="col-xs-12">
      <%= :species_list_show_no_members.tp %>
    </div>
<% end %>

<div class="col-xs-12">
  <%= render(partial: 'comment/show_comments', locals:
                                                     {object: @species_list, controls: true, limit: nil}) %>
</div>
<div class="col-xs-12">
  <%= show_object_footer(@species_list) %>
</div>
</div>